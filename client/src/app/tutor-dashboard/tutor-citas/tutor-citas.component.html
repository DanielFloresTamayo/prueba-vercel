<div class="citas-container">

  <h2 class="titulo">üì¨ Solicitudes de Citas</h2>

  <div *ngIf="!cargando && citas.length === 0" class="no-citas-card">
    <i class="bi bi-calendar-x no-citas-icon"></i>
    <h3>No tienes solicitudes por ahora</h3>
    <p>Cuando un participante solicite una clase, aparecer√° aqu√≠.</p>
  </div>

  <div class="filtros" >
    <button (click)="filtrarPorEstado('todas')">Todas</button>
    <button (click)="filtrarPorEstado('pendiente')">Pendientes</button>
    <button (click)="filtrarPorEstado('aceptada')">Aceptadas</button>
    <button (click)="filtrarPorEstado('rechazada')">Rechazadas</button>
    <button (click)="filtrarPorEstado('completada')">Completadas</button>
  </div>

  <div class="clases-grid">

    <div class="clase-card card-anim" 
         *ngFor="let cita of citasFiltradas; trackBy: trackByCita"
        [ngClass]="cita.estado"
        [attr._anim]="cita._anim ? 'true' : null">


      <div class="right-section">

        <!-- INFO PARTICIPANTE -->
        <h4 class="section-title">Informaci√≥n del participante</h4>

        <div class="tutor-section">

          <div class="info-row">
            <div class="label"><i class="bi bi-person-badge"></i><span>Participante:</span></div>
            <div class="value">
              {{ cita.participante?.nombres }} {{ cita.participante?.apellidos }}
            </div>
          </div>

          <div class="info-row">
            <div class="label"><i class="bi bi-envelope"></i><span>Correo:</span></div>
            <div class="value">{{ cita.participante?.correoPersonal }}</div>
          </div>

        </div>

        <!-- INFO CLASE -->
        <h4 class="section-title">Clase solicitada</h4>

        <div class="class-section">

          <div class="info-row">
            <div class="label"><i class="bi bi-book"></i><span>Asignatura:</span></div>
            <div class="value">{{ cita.clase?.materia }}</div>
          </div>

          <div class="info-row">
            <div class="label"><i class="bi bi-journal-text"></i><span>T√≠tulo:</span></div>
            <div class="value">{{ cita.clase?.titulo }}</div>
          </div>

          <div class="info-row">
            <div class="label"><i class="bi bi-chat-left-dots"></i><span>Descripci√≥n:</span></div>
            <div class="value">{{ cita.clase?.descripcion }}</div>
          </div>

        </div>

        <!-- DETALLES DE LA CITA -->
        <h4 class="section-title">Detalles de la solicitud</h4>

        <div class="class-section">

          <div class="info-row">
            <div class="label"><i class="bi bi-calendar-event"></i><span>Fecha:</span></div>
            <div class="value">{{ getFechaRelativa(cita.fechaSolicitud) }}</div>
          </div>

          <div class="info-row">
            <div class="label">
              <i class="bi bi-flag"></i><span>Estado:</span>
            </div>

            <div class="value estado" [ngClass]="cita.estado">
              <i [ngClass]="{
      'bi bi-hourglass-split': cita.estado === 'pendiente',
      'bi bi-check2-circle': cita.estado === 'aceptada',
      'bi bi-x-circle': cita.estado === 'rechazada',
      'bi bi-award': cita.estado === 'completada'
    }"></i>

              <span class="badge-text">{{ cita.estado }}</span>
            </div>
          </div>


        </div>

        <!-- BOTONES -->
        <div class="acciones" *ngIf="cita.estado === 'pendiente'">
          <button class="btn aceptar" (click)="aceptarCita(cita)">Aceptar</button>
          <button class="btn rechazar" (click)="rechazarCita(cita)">Rechazar</button>
        </div>
        <div class="acciones" *ngIf="cita.estado === 'aceptada'">
          <button class="btn completar" (click)="completarCita(cita)">Marcar como completada</button>
        </div>
      </div>

    </div>

  </div>

</div>